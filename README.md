# 机器学习 × 环境工程：基于高级特征工程与多模型融合的水质安全性预测研究

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)

## 🧪 1. 研究背景与科学说明
饮用水安全保障是环境工程的核心任务。本项目旨在利用机器学习算法，通过对**pH、硫酸盐、硬度、氯胺**等 9 项理化指标的监控，捕捉水处理过程中的工艺波动风险。

> **⚠️ 严谨性声明**：
> 根据 **GB 5749-2022** 标准，饮用水安全的第一优先级为**微生物指标**（如大肠菌群）。本项目由于数据集局限性，侧重于基于理化参数的**工艺稳定性预测**，其结果应视为“理化合规性参考”，而非最终的生物学饮用安全判定。

## 🚀 2. 核心技术路径
1. **高级特征工程**：构造了 `pH 偏移度`、`有机碳/氯胺比`、`消毒副产物生成潜力 (THM_per_OC)` 等具有工程解释性的衍生描述符。
2. **类别平衡策略**：针对安全水样稀缺问题，在 **5 折交叉验证** 框架下实施 **SMOTE** 过采样，确保模型对异常工况的识别率。
3. **贝叶斯优化集成架构**：构建了以 **CatBoost** 为核心的高性能梯度提升模型，并利用贝叶斯优化进行参数寻优。
4. **归因分析**：引入 **SHAP 框架**，实现从“统计关联”向“物理化学归因”的跨越。

## 📊 3. 实验结果展示

### 3.1 模型性能评价
对比实验表明，**CatBoost** 模型在处理水质多指标非线性关联方面展现出显著优势，最终性能指标如下：
* **ROC-AUC**: ≈ 0.68
* **性能增益**: 整合业务特征后，AUC 较基准模型提升 **0.14**

![ROC & PR 曲线图](./roc_pr_all_models.png)
**

### 3.2 特征关联性分析
通过相关性热图，我们识别了理化指标间的耦合关系，为特征筛选提供了科学依据。

![相关性热图](./fig2_corr_heatmap.png)
**

### 3.3 全局与局部归因分析 (SHAP)
SHAP 分析显示，**Sulfate（硫酸盐）**、**ph** 和 **Hardness（硬度）** 是模型判别的关键驱动因素。

![SHAP 全局解释图](./fig4_shap_summary.png)
**

下图展示了单一样本的决策过程：
![SHAP 瀑布图](./fig3_shap_bar.png)
**

## 🛠️ 4. 运行环境与使用
1. **安装依赖**: `pip install -r requirements.txt`
2. **运行 Notebook**: 打开 `baseline_template.ipynb` 即可重现实验流程。

## 🔮 5. 未来改进方向
* **指标补全**: 引入总大肠菌群、致病菌等微生物核心指标。
* **物理耦合**: 尝试将消毒动力学方程与神经网络（PINN）耦合。
* **决策辅助**: 开发基于 LLM 的智能化水质异常诊断助手。
